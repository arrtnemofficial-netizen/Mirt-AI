# Аналіз залежностей - 22 грудня 2025

## Статус перевірки

**Дата:** 22.12.2025  
**Статус:** ✅ Всі критичні конфлікти виправлені

## Результати перевірки

### 1. Синхронізація версій

✅ **requirements.txt та pyproject.toml синхронізовані**

Всі версії узгоджені між двома файлами:
- `pydantic==2.9.2` (синхронізовано)
- `httpx==0.27.2` (синхронізовано)
- `pytest-asyncio==1.3.0` (синхронізовано)

### 2. Відомі конфлікти

✅ **Всі відомі конфлікти виправлені:**

1. **httpx vs supabase** ✅ ВИПРАВЛЕНО
   - Проблема: `supabase 2.9.1` вимагає `httpx<0.28 and >=0.26`
   - Рішення: Використовується `httpx==0.27.2`
   - Статус: ✅ Сумісність забезпечена

2. **pydantic vs aiogram** ✅ ВИПРАВЛЕНО
   - Проблема: `aiogram 3.15.0` вимагає `pydantic<2.10 and >=2.4.1`
   - Рішення: Використовується `pydantic==2.9.2`
   - Статус: ✅ Сумісність забезпечена

3. **openai vs httpx** ✅ ПЕРЕВІРЕНО
   - Проблема: `openai 1.60.1` вимагає `httpx<1 and >=0.23.0`
   - Поточна версія: `httpx==0.27.2`
   - Статус: ✅ Сумісність забезпечена

### 3. Перевірка pip check

✅ **Конфліктів не виявлено**

```bash
pip check
# No broken requirements found.
```

### 4. Актуальність версій (22.12.2025)

⚠️ **11 пакетів мають новіші версії:**

| Пакет | Поточна | Остання | Рекомендація |
|-------|---------|---------|--------------|
| pydantic-ai | 1.23.0 | 1.37.0 | ⚠️ Оновити з обережністю (major updates) |
| langgraph | 1.0.4 | 1.0.5 | ✅ Безпечно оновити (patch) |
| openai | 1.60.1 | 2.14.0 | ⚠️ НЕ оновлювати (breaking changes v2) |
| pydantic | 2.9.2 | 2.12.5 | ⚠️ НЕ оновлювати (конфлікт з aiogram) |
| pydantic-settings | 2.7.1 | 2.12.0 | ⚠️ Оновити разом з pydantic |
| fastapi | 0.115.2 | 0.127.0 | ⚠️ Оновити з тестуванням |
| uvicorn | 0.32.0 | 0.40.0 | ⚠️ Оновити з тестуванням |
| httpx | 0.27.2 | 0.28.1 | ⚠️ НЕ оновлювати (конфлікт з supabase) |
| aiogram | 3.15.0 | 3.23.0 | ⚠️ Оновити з тестуванням |
| supabase | 2.9.1 | 2.27.0 | ⚠️ Оновити з тестуванням (може вирішити httpx конфлікт) |
| pytest | 9.0.1 | 9.0.2 | ✅ Безпечно оновити (patch) |

### 5. Транзитивні залежності

✅ **Перевірено через pip check**

Всі транзитивні залежності сумісні, конфліктів не виявлено.

### 6. Безпекові уразливості

⚠️ **Рекомендації:**

1. **Регулярно перевіряти CVE:**
   ```bash
   pip install pip-audit
   pip-audit
   ```

2. **Моніторинг безпеки:**
   - Використовувати GitHub Dependabot (якщо налаштовано)
   - Перевіряти PyPI Security Advisories
   - Моніторити офіційні канали бібліотек

3. **Критичні бібліотеки для моніторингу:**
   - `pydantic` - регулярні security updates
   - `httpx` - мережева бібліотека, критична для безпеки
   - `openai` - API клієнт, можливі зміни в безпеці
   - `fastapi` - веб-фреймворк, можливі вразливості

## Рекомендації по оновленню

### Безпечні оновлення (низький ризик)

✅ **Можна оновити одразу:**
- `langgraph`: 1.0.4 → 1.0.5 (patch update)
- `pytest`: 9.0.1 → 9.0.2 (patch update)

### Оновлення з тестуванням (середній ризик)

⚠️ **Оновити після тестування:**
- `fastapi`: 0.115.2 → 0.127.0 (minor updates)
- `uvicorn`: 0.32.0 → 0.40.0 (minor updates)
- `aiogram`: 3.15.0 → 3.23.0 (minor updates)

### Оновлення з обережністю (високий ризик)

⚠️ **Потрібен ретельний тест:**
- `pydantic-ai`: 1.23.0 → 1.37.0 (major updates, можливі breaking changes)
- `supabase`: 2.9.1 → 2.27.0 (може вирішити httpx конфлікт, але потрібен тест)

### НЕ оновлювати (через конфлікти)

❌ **Не оновлювати зараз:**
- `openai`: 1.60.1 → 2.14.0 (v2 має breaking changes)
- `pydantic`: 2.9.2 → 2.12.5 (конфлікт з aiogram 3.15.0)
- `httpx`: 0.27.2 → 0.28.1 (конфлікт з supabase 2.9.1)

## План оновлення (опціонально)

### Фаза 1: Безпечні оновлення
```bash
pip install --upgrade langgraph==1.0.5 pytest==9.0.2
```

### Фаза 2: Оновлення з тестуванням
```bash
# Після повного тестування
pip install --upgrade fastapi==0.127.0 uvicorn==0.40.0
```

### Фаза 3: Оновлення supabase (може вирішити httpx конфлікт)
```bash
# Якщо supabase 2.27.0 підтримує httpx 0.28.1, можна оновити обидва
pip install --upgrade supabase==2.27.0 httpx==0.28.1
```

### Фаза 4: Оновлення openai (потрібна міграція на v2)
```bash
# Після міграції коду на OpenAI v2 API
pip install --upgrade openai==2.14.0
```

## Висновки

1. ✅ **Всі критичні конфлікти виправлені**
2. ✅ **requirements.txt та pyproject.toml синхронізовані**
3. ✅ **pip check не виявляє конфліктів**
4. ⚠️ **Багато пакетів мають новіші версії, але оновлення потребує тестування**
5. ✅ **Поточні версії стабільні та сумісні**

## Інструменти для моніторингу

1. **Автоматична перевірка:**
   ```bash
   python scripts/check_dependencies.py
   ```

2. **Перевірка конфліктів:**
   ```bash
   pip check
   ```

3. **Перевірка безпеки:**
   ```bash
   pip install pip-audit
   pip-audit
   ```

4. **Візуалізація залежностей:**
   ```bash
   pip install pipdeptree
   pipdeptree
   ```

## Наступні кроки

1. ✅ Синхронізувати pyproject.toml з requirements.txt
2. ✅ Перевірити відомі конфлікти
3. ✅ Створити скрипт для автоматичної перевірки
4. ⚠️ Регулярно запускати `python scripts/check_dependencies.py`
5. ⚠️ Моніторити безпекові оновлення через pip-audit
6. ⚠️ Планувати оновлення з тестуванням

---

**Останнє оновлення:** 22.12.2025  
**Наступна перевірка:** Рекомендується щомісяця

