# План усунення «вайбкоду»

## Цілі
- Прибрати імпровізацію у доступі до каталогу: тільки валідувані записи, чіткі помилки.
- Забезпечити надійні виклики Supabase з ретраями, щоб не втрачати відповіді через тимчасові збої.
- Вирівняти метадані під вимоги промпту (session_id без вигаданих значень).

## Виконані кроки
1) Додано строгі ретраї та явний SupabaseToolError для RPC/SQL викликів, щоб агент або отримував дані, або піднімав керовану помилку.
2) Валідація рядків каталогу: без id/ціни/фото модель відкидається, тож агент ніколи не поверне напівпорожні товари.
3) Метадані за замовчуванням не підставляють штучний session_id, що відповідає контракту v6.0-final.

## Наступні пріоритети
- Додати структуроване логування викликів SupabaseToolError для спостережуваності.
- Підняти інтеграційні тести з моками Supabase RPC, щоб перевірити ретраї та валідацію під навантаженням.
- Інфраструктурно зафіксувати RLS/індекси через міграції, щоб уникати ручних кроків.
